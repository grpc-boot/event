<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>websocket</title>
</head>
<body>
<script src="crypto-js.min.js"></script>
<script src="protocol.js"></script>
<script>
    let proto = null;
    let timer = null;
    window.onload = function () {
        proto = new WsProtocol('ws://127.0.0.1:3333/ws', LevelV1, 'SD3c523asz7*&^df', '312c45cDvd4bFc12');
        if(!proto.dial()) {
            console.log('connect failed');
            return;
        }

        proto.ws.onopen = function (ev) {
            console.log("ws open", ev);
        }

        proto.ws.onmessage = function (me) {
            console.log("ws msg", me);
        }

        proto.ws.onclose = function (ev) {
            clearInterval(timer)
            console.log("close")
        }

        proto.ws.onerror = function (ev) {
            console.log(ev)
        }
    }
</script>
</body>
</html>